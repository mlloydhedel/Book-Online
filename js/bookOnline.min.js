function toggleService(e){if(e.checked){appointmentDuration+=servicesDB[e.value]["time"];totalPrice+=servicesDB[e.value]["price"];if(e.value=="Brow")brow=true;else if(e.value=="Lip")lip=true;else if(e.value=="Chin")chin=true;else if(e.value=="Chest_Men")chestmen=true;else if(e.value=="Back_Men")backmen=true}else{appointmentDuration-=servicesDB[e.value]["time"];totalPrice-=servicesDB[e.value]["price"];if(e.value=="Brow")brow=false;else if(e.value=="Lip")lip=false;else if(e.value=="Chin")chin=false;else if(e.value=="Chest_Men")chestmen=false;else if(e.value=="Back_Men")backmen=false}if(brow&&lip&&chin||lip&&chin)adjustment=-8;else adjustment=0;updateTotals("#servicesTabTotals");updateTotals("#appointmentTabTotals")}function updateTotals(e){var t="";clearAppointmentDate();if(totalPrice>0){if(isQuoteable())t="$"+calculatePrice();else t="call for price";t+="<br>"+appointmentDuration+" minutes";$(e).show();enableTab(1);enableNavButton("next")}else{$(e).hide();disableTab(1);disableTab(2);disableNavButton("next")}$(e).html(t)}function disableNavButton(e){$("a[href='#"+e+"']").css("visibility","hidden")}function enableNavButton(e){$("a[href='#"+e+"']").css("visibility","visible")}function isQuoteable(){return!(backmen||chestmen)}function padTwoDigits(e){if(e<10)return"0"+e;return e+""}function calculateEndTime(e){return new Date(e.getTime()+appointmentDuration*6e4)}function updateAppointmentSummary(){var e="";if(timeSelected)e="<br><span class='appointmentTimeRange'>"+getTimeString(appointmentDate,appointmentDuration)+"</span>";$("#appointmentConfirm").html(monthShortName[appointmentDate.getMonth()]+" "+appointmentDate.getDate()+e)}function processDateSelection(e,t){$("#timeOptions").hide();$("#appointment_spinner").show();timeSelected=false;disableTab(2);disableNavButton("next");$("#appointmentConfirm").show();appointmentDate=new Date(e.substring(0,4),parseInt(e.substring(4,6))-1,e.substring(6,8),0,0,0,0);updateAppointmentSummary();$.post("php/checkAvailability.php",{date:e,duration:t}).done(function(e){$("#appointment_spinner").hide();$("#timeOptions").show();$("#timeOptions").html(e)})}function updateAppointmentTime(e,t){appointmentDate=new Date(e*1e3);timeSelected=true;$(".availableTimeSelected").attr("class","availableTime");t.className="availableTimeSelected";enableNavButton("next");enableTab(2);buildConfirmationPage();updateAppointmentSummary()}function enableTab(e){if(e==1){$("li[class='disabled'][role='tab']").attr("class","done")}else if(e==2){$("li[class='disabled last'][role='tab']").attr("class","done last");$("li[class='last disabled'][role='tab']").attr("class","last done")}}function disableTab(e){if(e==1){$("li[class='done'][role='tab']").attr("class","disabled")}else if(e==2){$("li[class='done last'][role='tab']").attr("class","disabled last");$("li[class='last done'][role='tab']").attr("class","last disabled")}}function clearAppointmentDate(){var e=$("#datepicker").data("Zebra_DatePicker");e.clearDate();showAppointmentHelper();$("#appointmentConfirm").hide();appointmentDate=null;timeSelected=false;$("#confirm_servicesFacialPane").html("");disableTab(2)}function showAppointmentHelper(){$("#timeOptions").html("<div class='arrow_box'>Select a day from the calendar<br>to see what appointments are available.<br></div>")}function calculatePrice(){return totalPrice+adjustment}function buildConfirmationPage(){if(timeSelected){var e="";var t=new Array;var n="";$("input:checked").each(function(){if(this.name=="facial")n=this.value;else t.push(this.value)});if(n!=""){$("#confirm_servicesFacialPane").html(servicesDB[n]["label"]);$("#confirm_servicesFacialPane").show();if(t.length==0){$("#confirm_servicesFacialPane").attr("class","confirm_servicesFacialPaneMax");e+="<table>"}else if(t.length<=3){$("#confirm_servicesFacialPane").attr("class","confirm_servicesFacialPaneMid");e+="<table class='confirm_servicesTableMid'>"}else{$("#confirm_servicesFacialPane").attr("class","confirm_servicesFacialPane");e+="<table class='confirm_servicesTable'>"}}else{$("#confirm_servicesFacialPane").hide();e+="<table class='confirm_servicesTableMax'>"}var r=1;var i=4;for(var s=0;s<t.length;s++){if(r==1)e+="<tr>";e+="<td width='"+100/Math.min(i,t.length)+"%' ";if(t.length>12)e+="style='font-size:11px'";else if(t.length>i&&n=="")e+="style='font-size:15px'";e+=">"+servicesDB[t[s]]["label"]+"</td>";r++;if(r>i){if(s+1<t.length)r=1;e+="</tr>"}}if(r<i&&t.length>i){for(var s=0;s<i-r;s++)e+="<td> </td>";e+="</tr>"}e+="</table>";$("#confirm_servicesSummary").html(e);$("#confirm_appointmentDate").html(getDateString(appointmentDate));$("#confirm_appointmentTime").html(getTimeString(appointmentDate,appointmentDuration));if(isQuoteable())e="$"+calculatePrice();else e="call for price";$("#confirm_appointmentPrice").html(e)}}function nth(e){if(e>3&&e<21)return"th";switch(e%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}}function showContactFormHelper(){if($("#confirm_emailInput").val()!=""||$("#confirm_phoneInput").val()!=""){$("#confirm_inputHelper").css("visibility","hidden");showContactFormFormatHelpers()}else{$("#confirm_inputHelper").css("visibility","visible");hideContactFormFormatHelpers()}}function hideContactFormFormatHelpers(){$("#confirm_phoneFormatHelper").css("visibility","hidden");$("#confirm_emailFormatHelper").css("visibility","hidden")}function showContactFormFormatHelpers(){$("#confirm_phoneFormatHelper").css("visibility","visible");$("#confirm_emailFormatHelper").css("visibility","visible")}function getTimeString(e,t){var n=calculateEndTime(appointmentDate);var r=appointmentDate.getHours();if(r>12)r=padTwoDigits(r-12);return adjustMilitaryHours(appointmentDate.getHours())+":"+padTwoDigits(appointmentDate.getMinutes())+" - "+adjustMilitaryHours(n.getHours())+":"+padTwoDigits(n.getMinutes())}function adjustMilitaryHours(e){if(e>12)return e-12;return e}function getDateString(e){return dayNames[appointmentDate.getDay()]+", "+monthNames[appointmentDate.getMonth()]+" "+appointmentDate.getDate()+nth(appointmentDate.getDate())}function processFormSubmission(){$("a[href='#finish']").hide();$("#confirm_submitSpinner").show();var e="";$("input:checked").each(function(){e+=servicesDB[$(this).val()]["label"]+","});var t="";if($("#confirm_phoneErrorIcon").attr("class")=="confirm_errorMsgValid")t=$("#confirm_phoneInput").val();var n="";if($("#confirm_emailErrorIcon").attr("class")=="confirm_errorMsgValid")n=$("#confirm_emailInput").val();$.post("php/bookAppointment.php",{date:escape(appointmentDate.getTime()/1e3),timeStr:escape(getTimeString(appointmentDate,appointmentDuration)),dateStr:escape(getDateString(appointmentDate)),duration:appointmentDuration,price:calculatePrice(),email:escape(n),phone:escape(t),name:escape($("#confirm_nameInput").val()),services:escape(e)}).done(function(e){$("#confirm_submitSpinner").hide();$("#confirm_emailcell").css("visibility","hidden");$("#confirm_phonecell").css("visibility","hidden");$("#confirm_namecell").css("visibility","hidden");$("li[role='tab']").css("visibility","hidden");$("a[role='menuitem']").css("visibility","hidden");$(".confirm_errorMsg").css("visibility","hidden");$("#confirm_nameErrorIcon").css("visibility","hidden");if(bookingSuccess.test(e)){$("#confirm_submitFinished").show();$("#confirm_clientTips").show()}else{$("#confirm_submitFailed").show();$("#confirm_clientErrorTips").show()}$("#bookAgain").show()})}function cleanupFinishButton(){if($("#confirm_nameErrorIcon").attr("class")=="confirm_errorMsgValid"&&($("#confirm_phoneErrorIcon").attr("class")=="confirm_errorMsgValid"||$("#confirm_emailErrorIcon").attr("class")=="confirm_errorMsgValid")){$("a[href='#finish']").show();hideContactFormFormatHelpers()}else{$("a[href='#finish']").hide()}}var servicesDB={NPNG:{time:60,price:69,label:"NPNG Facial"},Cleansing:{time:60,price:95,label:"Cleansing Facial"},Hydrating:{time:60,price:95,label:"Hydrating Facial"},Verbena:{time:60,price:89,label:"Verbena Facial"},Brightening:{time:60,price:95,label:"Brightening Facial"},Soothing:{time:60,price:95,label:"Soothing Facial"},Brow:{time:15,price:20,label:"Brow Wax"},Underarm:{time:15,price:20,label:"Underarm Wax"},Lower_Back:{time:30,price:25,label:"Lower Back Wax"},Full_Leg:{time:60,price:80,label:"Full Leg Wax"},Lip:{time:15,price:15,label:"Lip Wax"},Half_Arm:{time:30,price:25,label:"Half Arm Wax"},Bikini:{time:30,price:25,label:"Bikini Wax"},Chest_Men:{time:60,price:55,label:"Mens Chest Wax"},Chin:{time:15,price:15,label:"Chin Wax"},Full_Arm:{time:60,price:50,label:"Full Arm Wax"},Half_Leg:{time:30,price:48,label:"Half Leg Wax"},Back_Men:{time:60,price:55,label:"Mens Back Wax"},Lactic_Peel:{time:15,price:22,label:"30% Lactic Peel"},Eye_Treatment:{time:15,price:15,label:"Eye Treatment"},Cold_Aloe_Mask:{time:15,price:18,label:"Cold Aloe Mask"},High_Frequency:{time:15,price:5,label:"High Frequency"},Pumpkin_Peel:{time:15,price:15,label:"Pumpkin Peel"},Collagen_Ampoule:{time:15,price:15,label:"Collagen Ampoule"},Aroma_Therapy:{time:15,price:8,label:"Aromatherapy"},Advanced_Extraction:{time:15,price:10,label:"Advanced Extraction"},Hand_Treatment:{time:15,price:10,label:"Hand Treatment"},Makeup_Application:{time:30,price:29,label:"Makeup Application"},Body_Exfoliation:{time:60,price:85,label:"Body Exfoliation"},Back_Exfoliation:{time:60,price:55,label:"Back Exfoliation"}};var dayNames=new Array("Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday");var monthNames=new Array("January","February","March","April","May","June","July","August","September","October","November","December");var monthShortName=new Array("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec");var emailCheck=/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;var phoneNumberCheck=/^1?([2-9]..)([2-9]..)(....)$/;var bookingSuccess=/SUCCESS/;var appointmentDuration=0;var totalPrice=0;var appointmentDate=null;var timeSelected=false;var brow=false;var chin=false;var lip=false;var chestmen=false;var backmen=false;var adjustment=0